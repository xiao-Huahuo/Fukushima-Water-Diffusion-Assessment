# 问题一：核废水三维扩散模型（修正版）

## 1. 模型概述

为了模拟放射性核素在海洋中的迁移，我们考虑了洋流平流、湍流扩散和放射性衰变三大物理机制，建立了一个三维对流-扩散-衰变耦合模型。

---

## 2. 控制方程

### ⑴ 三维对流-扩散-衰变方程

$$\frac{\partial{C}}{\partial{t}}+u\frac{\partial{C}}{\partial{x}}+v\frac{\partial{C}}{\partial{y}}+w\frac{\partial{C}}{\partial{z}}=D_h\left(\frac{\partial^2{C}}{\partial{x^2}}+\frac{\partial^2{C}}{\partial{y^2}}\right)+D_v\frac{\partial^2{C}}{\partial{z^2}}-\lambda C+S$$

**方程说明**：
- **左侧**：时间变化项 + 洋流平流输送项
- **右侧**：水平扩散项 + 垂直扩散项 - 核素衰变项 + 源项

### ⑵ 方程各项说明

| 项 | 物理意义 | 说明 |
|---|----------|------|
| $\frac{\partial{C}}{\partial{t}}$ | 浓度随时间变化率 | 待求解量 |
| $u, v, w$ | 洋流在 $x, y, z$ 方向流速 | 从 Argo 海洋数据中获取 |
| $D_h, D_v$ | 水平和垂直扩散系数 | 来源于 IAEA 2024<br>$D_h = 500\,\text{m}^2/\text{s}$<br>$D_v = 10^{-4}\,\text{m}^2/\text{s}$ |
| $\lambda C$ | 放射性衰变项 | $\lambda = \frac{\ln 2}{T_{1/2}}$，半衰期见题目 |
| $S$ | 污染源项 | 福岛排放点源强 |

---

## 3. 数值求解方法

### ⑴ 有限体积法

采用**有限体积法**（Finite Volume Method, FVM），将计算区域离散为三维网格单元。该方法的优势：
- ✅ 自动满足质量守恒
- ✅ 适用于复杂地形
- ✅ 易于处理边界条件

### ⑵ 离散格式（修正版）

#### **平流项离散（上风格式 + 开放边界）**

为避免边界处的"虚空浓度"问题（循环回绕导致），采用**单侧差分**：

**X 方向（经度）**：
$$\frac{\partial C}{\partial x} \approx \begin{cases}
\frac{C_{i,j,k} - C_{i-1,j,k}}{\Delta x} & \text{if } u > 0 \text{ and } i > 0 \\
\frac{C_{i+1,j,k} - C_{i,j,k}}{\Delta x} & \text{if } u < 0 \text{ and } i < n_x-1 \\
0 & \text{边界点（开放边界条件）}
\end{cases}$$

**Y 方向（纬度）** 和 **Z 方向（深度）** 类似处理。

**关键改进**：
- ❌ **旧方法**：`np.roll()` 循环平移 → 导致南太平洋出现虚假高浓度
- ✅ **新方法**：显式边界判断 → 物理上合理的开放边界

#### **扩散项离散（中心差分）**

**水平扩散**：
$$\frac{\partial^2 C}{\partial x^2} \approx \frac{C_{i+1,j,k} - 2C_{i,j,k} + C_{i-1,j,k}}{(\Delta x)^2}$$

**垂直扩散**：
$$\frac{\partial^2 C}{\partial z^2} \approx \frac{C_{i,j,k+1} - 2C_{i,j,k} + C_{i,j,k-1}}{(\Delta z)^2}$$

#### **时间推进（显式欧拉法）**

$$C^{n+1} = C^n + \Delta t \cdot \left[\text{平流} + \text{扩散} - \text{衰变} + \text{源项}\right]$$

**稳定性条件**（CFL 条件）：
$$\Delta t \leq \min\left\{\frac{\Delta x}{|u|}, \frac{\Delta y}{|v|}, \frac{(\Delta x)^2}{2D_h}\right\}$$

本研究采用 $\Delta t = 6$ 小时，满足稳定性要求。

---

## 4. 初始条件与边界条件

### ⑴ 初始条件（$t = 0$, 2023年8月24日）

**源项函数**：
$$S(x,y,z,t) = Q_t \cdot \delta(x - x_0) \cdot \delta(y - y_0) \cdot \delta(z - z_0)$$

**排放点坐标**：
- 经度：$x_0 = 141.03°\text{E}$
- 纬度：$y_0 = 37.42°\text{N}$
- 深度：$z_0 = 0\,\text{m}$（海面）

**源项强度（修正版）**：

| 核素 | 排放量<br>$Q_{\text{mass}}$ (吨/天) | 比活度<br>(Bq/吨) | 源项强度<br>$Q_t$ (Bq/s) |
|------|----------------------------------|------------------|------------------------|
| 氚 (³H) | 100 | $3.7 \times 10^{14}$ | $4.28 \times 10^{11}$ |
| 碳-14 (¹⁴C) | 50 | $1.6 \times 10^{11}$ | $9.26 \times 10^{7}$ |
| 锶-90 (⁹⁰Sr) | 200 | $5.1 \times 10^{15}$ | $1.18 \times 10^{13}$ |
| 碘-129 (¹²⁹I) | 30 | $6.5 \times 10^{9}$ | $2.26 \times 10^{6}$ |

**计算公式**：
$$Q_t\,(\text{Bq/s}) = \frac{Q_{\text{mass}}\,(\text{吨/天}) \times \text{比活度}\,(\text{Bq/吨})}{86400\,(\text{s/天})}$$

**初始浓度场**：
$$C(x,y,z,t=0) = 0\quad \forall\,(x,y,z) \neq (x_0, y_0, z_0)$$

---

### ⑵ 边界条件（修正版）

#### **① 海面和海底（无通量边界）**

**Neumann 边界条件**：
$$\left.\frac{\partial C}{\partial z}\right|_{z=0} = 0 \quad \text{(海面)}$$
$$\left.\frac{\partial C}{\partial z}\right|_{z=-H} = 0 \quad \text{(海底)}$$

**物理意义**：
- 核素不能穿越海面进入大气
- 核素不能穿透海底进入沉积物

**数值实现**：
```python
# 海面（表层）
C[0, :, :] = C[1, :, :]

# 海底（底层）
C[-1, :, :] = C[-2, :, :]
```

#### **② 开放海洋边界（Orlanski 辐射条件）**

**东、西、南、北边界**：
$$\frac{\partial C}{\partial t} + c_{\text{phase}} \frac{\partial C}{\partial n} = 0$$

其中 $c_{\text{phase}}$ 为波速，$n$ 为边界法向。

**物理意义**：
- 允许核素自由流出计算区域
- 防止虚假反射

**数值实现**：
```python
# 单侧差分 + 边界开放
if i == 0:  # 西边界
    adv_x = 0  # 允许流出
elif i == nx-1:  # 东边界
    adv_x = 0
```

#### **③ 陆地边界（固壁条件）**

**陆地掩码**：
$$C(x,y,z,t) = 0 \quad \forall\,(x,y) \in \text{陆地}$$

**检测方法**：
```python
# 速度为 0 的地方识别为陆地
land_mask = (u == 0) & (v == 0)
C[land_mask] = 0  # 强制陆地浓度为 0
```

---

## 5. 长期模拟策略（1年数据 → 10年模拟）

### ⑴ 问题描述

输入数据仅包含 **2023年8月24日至2024年8月24日**（1年）的洋流场，但需要模拟 **10年** 的扩散过程。

### ⑵ 解决方案

**方法1：周期性重复（基准方案）**
```python
# 循环使用1年数据
time_idx = (step * Δt / 86400) % 365
```

**方法2：年际趋势调整（改进方案）**
```python
# 假设洋流逐年减弱 2%
current_year = (step * Δt) / (365.25 * 86400)
year_factor = 1.0 - 0.02 * current_year
u_adjusted = u_monthly[time_idx] * year_factor
```

**方法3：气候模式预测（理想方案）**
- 使用 CMIP6 气候模型预测未来洋流变化
- 考虑全球变暖对洋流的影响
- 本研究未采用（数据获取困难）

### ⑶ 不确定性分析

由于仅使用1年数据，模拟结果存在以下不确定性：
- 年际变化：实际洋流受 ENSO、PDO 等影响
- 极端事件：台风、风暴潮等未充分体现
- 长期趋势：气候变化导致的洋流模式改变

**建议**：将模拟结果视为**代表性情景**，而非精确预测。

---

## 6. 最早到达时间分析

### ⑴ 定义

定义检测阈值：
$$C_{\text{threshold}} = 0.1\,\text{Bq/m}^3$$

**到达时间**：
$$t_{\text{arrival}}(x,y,z) = \min\{t \mid C(x,y,z,t) \geq C_{\text{threshold}}\}$$

即浓度首次超过阈值的时间。

### ⑵ 计算方法
```python
# 初始化到达时间数组（NaN 表示未到达）
arrival_time = np.full(shape, np.nan)

# 每个时间步检查
if C[i,j,k] >= C_threshold and np.isnan(arrival_time[i,j,k]):
    arrival_time[i,j,k] = current_time
```

### ⑶ 应用

- 识别高风险区域优先级
- 评估不同海域的响应时间
- 为监测网络布设提供依据

---

## 7. 模型验证

### ⑴ 质量守恒检验

$$M_{\text{total}}(t) = \iiint C(x,y,z,t)\,dx\,dy\,dz + \int_0^t \lambda M(t')\,dt' = \int_0^t Q_t\,dt'$$

即：系统总质量 = 累计排放 - 累计衰变

### ⑵ 数值稳定性检验

- CFL 数：$\text{CFL} = \frac{|u|\Delta t}{\Delta x} < 1$
- 浓度非负性：$C \geq 0$ 恒成立
- 无虚假振荡

### ⑶ 物理合理性检验

- ✅ 最大浓度出现在源点附近
- ✅ 浓度随距离和时间递减
- ✅ 南太平洋无虚假高浓度（修正前有此问题）
- ✅ 边界处浓度平滑变化

---

## 8. 关键改进总结

### ⑴ 问题修正对照表

| 问题 | 原因 | 修正方法 | 效果 |
|------|------|---------|------|
| 南太平洋虚空浓度 | `np.roll()` 循环回绕 | 单侧差分 + 开放边界 | ✅ 消除虚假浓度 |
| 浓度数量级错误 | 源项未换算为 Bq | 加入比活度转换 | ✅ 数值合理 |
| 边界浓度突变 | 边界处理不当 | 开放边界条件 | ✅ 浓度平滑 |
| 陆地有浓度 | 未识别陆地 | 添加陆地掩码 | ✅ 陆地浓度为0 |

### ⑵ 单位换算说明

**浓度单位关系**：
$$1\,\text{Bq/L} = 1000\,\text{Bq/m}^3$$

**本模型输出单位**：Bq/m³

**与他人结果对比时注意单位转换**：
- 如果别人用 Bq/L，你的数值应该是他们的 1/1000
- 如果数值相近，说明原模型源项强度设置有误

---

## 9. 输出结果

模型输出包含：

### ⑴ 浓度场时间序列

- 格式：NetCDF (`.nc`)
- 维度：`(time, depth, latitude, longitude)`
- 变量：`concentration` (Bq/m³)
- 时间分辨率：每周保存一次
- 空间分辨率：1° × 1°

### ⑵ 到达时间地图

- 格式：NetCDF / NumPy (`.npy`)
- 维度：`(depth, latitude, longitude)`
- 变量：`arrival_time` (天)
- 用途：识别高风险区域及响应时间

### ⑶ 统计数据

- 最大浓度随时间变化
- 源点浓度变化
- 总质量守恒验证
- 到达阈值的网格数

---

## 10. 计算性能

### ⑴ 优化策略

1. **活跃区域计算**：只计算浓度 > 0 的区域附近
2. **向量化操作**：使用 NumPy 批量计算
3. **检查点保存**：每年保存一次，防止中断丢失
4. **时间步长优化**：6小时步长，加速6倍

### ⑵ 预期性能

| 核素 | 网格规模 | 时间步数 | 预计耗时 |
|------|---------|---------|---------|
| 全部 | 125×230×32 | 14,600 | 2-4 小时 |

---

## 参考文献

1. IAEA (2024). *Safety Standards for Protecting People and the Environment*
2. Orlanski, I. (1976). *A Simple Boundary Condition for Unbounded Hyperbolic Flows*. J. Comp. Phys.
3. TEPCO (2023). *Fukushima Daiichi Nuclear Power Station ALPS Treated Water*
4. Argo Program (2024). *Global Ocean Observation Data*

---

**修订日期**：2025-11-16  
**版本**：v2.0（修正边界条件与源项强度）  
**关键改进**：消除虚空浓度、修正源项强度、改进边界条件
